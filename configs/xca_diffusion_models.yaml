# XCA 데이터셋 Diffusion 모델 학습 설정
model:
  arch_name: segdiff
  image_size: 224
  dim: 32
  timesteps: 100
  learning_rate: 0.0002
  num_classes: 2
  use_ema: true
  ema_decay: 0.9999
  num_ensemble: 1
  # 소프트 라벨 생성 설정 (forward diffusion에서 디노이징 타겟으로 사용)
  # 옵션: 'none' (이진), 'boundary', 'thickness', 'sauna' (경계+두께)
  soft_label_type: none
  soft_label_cache: true
  soft_label_fg_max: 11
  soft_label_thickness_max: 13
  soft_label_kernel_ratio: 0.1

data:
  name: xca
  train_dir: data/xca_dataset_split/train
  val_dir: data/xca_dataset_split/val
  test_dir: data/xca_dataset_split/test
  crop_size: 320
  train_bs: 4
  num_samples_per_image: 4

trainer:
  max_epochs: 400
  accelerator: gpu
  devices: 1
  precision: 32
  log_every_n_steps: 10
  check_val_every_n_epoch: 20
  accumulate_grad_batches: 2
  gradient_clip_val: 1.0
  callbacks:
    - class_path: lightning.pytorch.callbacks.ModelCheckpoint
      init_args:
        monitor: val/dice
        mode: max
        save_last: true
        verbose: true

  logger:
    class_path: lightning.pytorch.loggers.TensorBoardLogger
    init_args:
      save_dir: lightning_logs
      name: xca
      version: null
